## –ö–∞–∫ –ø–æ–¥–Ω—è—Ç—å üõ†Ô∏è

#### 0. –õ–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–º–µ—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π minikube –∏ –ø–æ–¥–Ω—è—Ç—å –µ–≥–æ, –∞ —Ç–∞–∫–∂–µ –æ—Ç–∫—Ä—ã—Ç—å —Ç—É–Ω–µ–ª—å:
```sh
minikube start
minikube tunnel
```

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ —Ä–∞–±–æ—Ç—É –Ω–∞ –¥–æ–º–µ–Ω–µ `bighw.com`, –∞ Grafana –∏ Zipkin –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ —Ä–∞–±–æ—Ç—É –Ω–∞ –¥–æ–º–µ–Ω–∞—Ö `grafana.local` –∏ `zipkin.local`
–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ –º–∞—à–∏–Ω–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ `/etc/hosts` –¥–æ–±–∞–≤–∏—Ç—å:
```txt
127.0.0.1       bighw.com
127.0.0.1       grafana.local zipkin.local
```
–¢–∞–∫–∂–µ –≤ –∫–æ—Ä–Ω–µ –ø–∞–ø–∫–µ –µ—Å—Ç—å `docker-compose.yaml`. –° –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –ø–æ–¥–Ω–∏–º–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –ë–î:
```sh
docker compose up --build -d
```
#### 1. –ü–æ–¥–Ω–∏–º–∞–µ–º Prometheus
–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É: `minikube start`.
–í –ø–∞–ø–∫–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É:
```sh
kubectl apply -f ./addons/prometheus.yaml
```
P.S. Prometheus –Ω—É–∂–µ–Ω, —á—Ç–æ–±—ã –≤—Å–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–¥–Ω—è–ª–æ—Å—å. 

#### 2. –ü–æ–¥–Ω–∏–º–∞–µ–º –∫–ª–∞—Å—Ç–µ—Ä (minikube)
–ü–æ–¥–Ω–∏–º–∞–µ–º –Ω–∞—à–∏ –ø–æ–¥—ã:
```sh
helmfile -e devel apply
```
–î–∞–ª–µ–µ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –¥–∞—à–±–æ—Ä–¥:
- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ `grafana.local` –∏ –≤–≤–æ–¥–∏–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ `admin:admin`.
- Dashboards -> Muffin logs

–¢–µ–ø–µ—Ä—å —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–µ–º–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–±–æ–ª—å—à–µ –ª–æ–≥–æ–≤. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –º–æ–∂–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–æ—Ç —Ç–∞–∫:
```sh
for i in $(seq 1 100); curl -s -o /dev/null -X 'POST' 'http://bighw.com/v1/muffin-wallet/32354edf-4466-4599-8363-d14a386309dc/transaction' -H 'accept: application/json' -H 'Content-Type: application/json' -d '{ "to_muffin_wallet_id": "386b8757-f4b3-4280-8910-5b54a7959ace", "amount": 1 }'
```
–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–∞–º—ã–µ —Å–≤–µ–∂–∏–µ –ª–æ–≥–∏ –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø–æ–ª—é `Time`.

–¢–∞–∫–∂–µ –º–æ–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —É—Ä–æ–≤–Ω—é –ª–æ–≥–æ–≤ –∏ TraceId - –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –¥–∞—à–±–æ—Ä–¥–∞ –µ—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. 

#### 3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞
–£–¥–∞–ª—è–µ–º –Ω–∞—à–∏ –ø–æ–¥—ã:
```sh
helmfile -e devel destroy
```
–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ë–î:
```sh
docker compose down -v
```
–ù—É –∏ —É–¥–∞–ª—è–µ–º prometheus:
```sh
kubectl -f ./addons/prometheus.yaml
```
–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç—É–Ω–Ω–µ–ª—å minikube (–µ—Å–ª–∏ –æ–Ω –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω) - `Ctrl + C`.





